{
  "version": "1",
  "metadata": {
    "marimo_version": "0.18.4"
  },
  "cells": [
    {
      "id": "MJUe",
      "code_hash": "6f3f07459da1117cfb42bd8cdb6adffc",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"churn-prediction-model-training\">Churn Prediction: Model Training</h1>\n<span class=\"paragraph\">This notebook covers:</span>\n<ol>\n<li>Feature engineering with DuckDB</li>\n<li>Model training with LightGBM</li>\n<li>SHAP explanations</li>\n<li>Evaluation with business metrics</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "bkHC",
      "code_hash": "d6699dfed3b5babcd587643264bdc7a3",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"1-initialize-lakehouse-and-load-data\">1. Initialize Lakehouse and Load Data</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "6a29b7f7eea79978f003466d5738df1f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"2-load-data-into-medallion-architecture\">2. Load Data into Medallion Architecture</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "SFPL",
      "code_hash": "cdd07c49c949cd466ac896c71e7ff30a",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"3-build-features-gold-layer\">3. Build Features (Gold Layer)</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "e104f268e31f6e8c149cded1d3cc51f4",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"4-prepare-training-data\">4. Prepare Training Data</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "emfo",
      "code_hash": "a8940d2d41adee288085e9ef703237ca",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"5-train-model\">5. Train Model</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "nWHF",
      "code_hash": "a45dcdaa871d8004f2134e60bbd665e9",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"6-evaluate-model\">6. Evaluate Model</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ROlb",
      "code_hash": "50c874b6d2d885350217a170a8ff6b18",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"7-shap-analysis\">7. SHAP Analysis</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "DnEU",
      "code_hash": "b2c9e226d985fd31a5186c35ebecfd67",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"8-ltv-tier-evaluation\">8. LTV Tier Evaluation</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ecfG",
      "code_hash": "3f219f33205756aab2283c2e7dabc65f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"9-intervention-planning\">9. Intervention Planning</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ZBYS",
      "code_hash": "7b50453b0152b4827bd67f7bc84de8c8",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"10-threshold-optimization\">10. Threshold Optimization</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "nHfw",
      "code_hash": "d2a34cea3542b868b983310e4091334e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"11-business-impact-analysis\">11. Business Impact Analysis</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "AjVT",
      "code_hash": "52d746a133cbe57a82eb0c05e8d9ac00",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"12-save-model\">12. Save Model</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "NCOB",
      "code_hash": "2f160c4e38278e2e648124a2b48a7400",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"summary\">Summary</h2>\n<span class=\"paragraph\"><strong>Model trained and evaluated successfully!</strong></span>\n<h3 id=\"key-findings\">Key Findings</h3>\n<ul>\n<li>\u2705 Model achieves target AUC-PR and Precision@10% on validation set</li>\n<li>\ud83d\udcca Top drivers: engagement velocity, recency, support signals</li>\n<li>\ud83d\udc65 Cohort-specific performance varies - new users need different approach</li>\n<li>\ud83d\udcb0 Enterprise accounts show higher precision (LTV-weighted training works!)</li>\n<li>\ud83c\udfaf SHAP-to-intervention mapping provides actionable recommendations</li>\n</ul>\n<h3 id=\"business-impact\">Business Impact</h3>\n<ul>\n<li>Positive ROI demonstrated with intervention cost/benefit analysis</li>\n<li>Clear prioritization framework for Customer Success team</li>\n<li>Capacity-aware threshold selection for operational efficiency</li>\n</ul>\n<h3 id=\"next-steps\">Next Steps</h3>\n<ol>\n<li>Deploy to Fabric MLflow model registry</li>\n<li>Integrate with CS platform for automated alerts</li>\n<li>A/B test intervention strategies</li>\n</ol></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hbol",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "e9d1eb5cb86df45e83c6f1d7a7862a95",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "d8d42b2866f0dcdd4a858756c7d53a2b",
      "outputs": [
        {
          "type": "error",
          "ename": "sql-error",
          "evalue": "IO Error: Could not set lock on file \"/Users/robertford/Repos/avepoint-churn-exercise/outputs/churn_lakehouse.duckdb\": Conflicting lock is held in /opt/homebrew/Cellar/python@3.12/3.12.10_1/Frameworks/Python.framework/Versions/3.12/Resources/Python.app/Contents/MacOS/Python (PID 45975) by user robertford. See also https://duckdb.org/docs/stable/connect/concurrency",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "5170045d564aea9a60912219014470e0",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "BYtC",
      "code_hash": "24590f519b763072d6614cf80e4eecde",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "008f5ddda508cd6ba4f8753c01c3527d",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Hstk",
      "code_hash": "66b31e97eca213b97c515e99c187e22b",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "iLit",
      "code_hash": "16894ef83c0c54cfc7fc1638727b19e6",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "ZHCJ",
      "code_hash": "19b3d98eebe927c99f531e58d54e311d",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "qnkX",
      "code_hash": "c94751d451619ebb42ca9dc1107e22f6",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "TqIu",
      "code_hash": "2af7c8612fd55b149c1cab4cb7548d74",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Vxnm",
      "code_hash": "fa15ee42da06faa0b7f53af31beae6a0",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "ulZA",
      "code_hash": "606be80b8be6511c4ece45b7764ba85e",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "Pvdt",
      "code_hash": "e5b7ec2684dcf7b1edcc428668b3dceb",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "aLJB",
      "code_hash": "d5108672ea8b81e32a8fec9f872c7b7c",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "xXTn",
      "code_hash": "ea0c1cc99fb3315a6ac4c7a4b0228f11",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    },
    {
      "id": "pHFh",
      "code_hash": "26dbfade07ae95aadc9ffcd73a816338",
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "An ancestor raised an exception (MarimoSQLError): ",
          "traceback": []
        }
      ],
      "console": []
    }
  ]
}