<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>01_eda.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>Churn EDA - Data Profiling &amp; Analysis</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-3OIHLLq_.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/preload-helper-g1IWzEZ-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEventListener-4mpeqPxW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jsx-runtime-DUsrKwmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Combination-D2HqSOvH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clsx-FpJB9huX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cn-Cs2e4A8T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/menu-items-B57SjdWM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hotkeys-Dh4gy4JD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/button-D8mnDDLX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Dj-O1Spr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createLucideIcon-BJ2I6csQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/check-CWbw3kKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/select-CgZgQ5hV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/multi-map-D3NvLiI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chevron-right-B_qBg_RU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dropdown-menu-Ciqx4yT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-DqNvr2Rw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/invariant-Amh6wt4N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/merge-5YNOh9ZD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utils-x9KlwLm7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/requests-THIDPq-F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/once-BxRirs3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toDate-Y5T6FHPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSlice-BoaxdS7L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_hasUnicode-CNlKPr15.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useLifecycle-8fgb5Nue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capitalize-L9-XHPtm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ai-model-dropdown-CO52rzQt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/badge-Cm0WUI-_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/use-toast-DKTyV2AR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/constants-BmIIVBf_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Deferred-9HYzcD3r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/config-CbG7e0K6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/uuid-B8w6pjWV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/DeferredRequestRegistry-DfLQSvoS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/connection-B11rCPnY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNonce-D8CLFIrY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capabilities-Bdlrhekp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createReducer-VgoBNe3M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-C3a_7WFa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-0z0sEYV-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzfTz_Dx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DmruaXMM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DU0YrNRK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-_bGPtAsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DsSBESho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-B2TjmP7E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzDb7E9f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stex-C4ZxI0N3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cjs-Ba5CQnxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_arrayReduce-DdxhySYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/type-kFt-n-jZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseProperty-D0ckTA0L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/now-CAWn5i9V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/debounce-Bgq-wc7M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/main-CC_mbgxK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-DoKM12vd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/kbd-EdFdwHEs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/renderShortcut-CLenKJO6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEvent-l9BzRqpK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeleteCell-BDBSmjLV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lazy-Cbg8zRvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-8c1ixjJ_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/precisionRound-CQhbsDNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-BECdiY5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vega-loader.browser-DZ31-605.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-CSAGVmjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ErrorBoundary-6EjkHrSV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-dialog-D9SwG8oA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dialog-BPIq0Dmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDebounce-C9S6xmGh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/numbers-BigybruE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/SSRProvider-DlZbKHsu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/context-CO64Gasq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNumberFormatter-B5HAJDUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/usePress-DHxqjtDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/input-CVoLDDk-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ImperativeModal-ameyIrhc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cell-link-BiAu_8pk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-D5BMn3Et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/links-Iv0WhyKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/state-i7G4J1VS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/MarimoErrorOutput-Bh7Bgl2Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-BS3uwoaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-DhmkXAPp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-icon-Lyk2_Z8G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spinner-DpaQpaiI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D1pae9A2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/focus-CyxSol0W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/popover-DZBXSGEz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useRunCells-DT1En-Te.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mode-DKDAYLK9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/purify.es-hXMlfS4W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/RenderHTML-Dlz0Ew2i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-CesNYRF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tabs-BjAbB8w_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-missing-import-DV1FOw9w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAsyncData-_-DLduEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useIframeCapabilities-r0LQMxAQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/LazyAnyLanguageCodeMirror-C7KtNlRp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/error-banner-C9tkg1MX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/formats-C3exma5i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useTheme-DpA-8Qyy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/en-US-Lc4gASCJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isValid-Cd_L_2Pm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/maps-D4abje2p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shim-D-ElLTBO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-CCvBQ7qL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/extends-C2lJEiP_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/emotion-is-prop-valid.esm-c4A1huxA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDateFormatter-BMdQ9MI_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/katex-BmfUoCWW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/marked.esm-idL59iHw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-T7OEMACY-CdGEwedE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/range-Bbli-TEL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-kHJ0xpFt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DxdWGPFi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/name-cell-input-C6ZYU6mN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useHotkey-B0ylhc2m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CqHWOZu2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BcLYYUSi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BVXr6b5T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BrEX5EQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CalRK9ms.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Cc4T7UUX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D3MC5WiF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DgaCIZAa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-rqHtY98i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-tj-jaP-y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-w7c0BKrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CCZcRJI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CrDb6akR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/apl-BQt6lLuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asciiarmor-BjX7bs0j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asn1-xn1MtyoW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/brainfuck-BjO-UY1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clike-DW9tQWfF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clojure-BSW96HRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cmake-C7UlMfz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cobol-CyWIev3Y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/coffeescript-DTvziYTK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/commonlisp-yMdkdGMi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/crystal-BGnoSp3z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/css-D7fWzevp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cypher-Cr1dl0Qf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/d-C2bS5bA6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/diff-B2mHQyn6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dtd-Cy-lUE7p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dylan-mm60grwk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ecl-Cqi05Wy1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eiffel-FkvfLQq7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/elm-Da5txHw0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/erlang-CdnCEH5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/simple-mode-B185hCuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/factor-CamlR8EJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/forth-UcMX0m31.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/fortran-DZ_vNVsP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gas-CM88o6Zj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gherkin-BhrpTeN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/groovy-BFju68Wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haskell-CrWHY4et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haxe-1eKW-tbO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/idl-Do4AwvU2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/javascript-CTXZKRYd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/julia-BRynwHI4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/livescript-ZmIBNA-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lua-mUfZ-MRC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mathematica-Dil5dTHO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mbox-Dnkn9wSr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mirc-auEWieOB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mllike-xVJsauJ8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/modelica-B8kajVDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mscgen-Bsnta1jn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mumps-CMw16b5q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/nsis-DwPdi8sw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ntriples-O5lQxirn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/octave-CMfAar-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/oz-CLRI9Qww.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pascal-D2M_3HBx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/perl-B8lV7aKt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pig-Bima2bfE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/powershell-v_t41ydu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/properties-ChrStSby.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/protobuf-Bin6kmlf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pug-UWVdYLYW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/puppet-DYrtWvYn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/python-BuKrulde.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/q-CrXUTiVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/r-Bk2Tiso2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/rpm-CmmZphz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ruby-ElyOTVeQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sas-jE3ZlG0K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/scheme-CZF1tRbv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shell-LqT3ZqMa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sieve-y15yT7Pp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/smalltalk-pk5PvsMs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sparql-DTZ_gfPQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stylus-CrGj0eNT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/swift-tt3PlBbI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tcl-1P4b0GMJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textile-BHDIuMYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toml-C8qoqk_i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/troff-DMiF5Zmz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-cfg-qLZtNU-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-BAUp3RZn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/turtle-BizIwmKv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vb-Bn_uCxNL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vbscript-BTKW8Atx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/velocity-CcB05fpi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/verilog-BWdtOJH8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vhdl-CzFOaOHx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/webidl-DDEKCqSy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/xquery-BcF6ZhQP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/yacas-BARQAiXa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/z80-DO_Ep0iT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-DnNh7vdQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/objectWithoutPropertiesLoose-DDabolgJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-Crqxhl3F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-Df8Wb7xS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-D8ETq-cc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/icons-BgmgMjOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/blob-LiDbeYko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-cell-with-ai-85tnyxYo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chart-no-axes-column-BrQ3B3xc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-function-D5EEjILG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spec-DpllSlJD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useInstallPackage-BaAhpZlP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/column-preview-DGBk0umL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAddCell-DYfGo4T8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toggle-PGHtwx2G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/api-CoLss8_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globals-oV9pRUSB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/share-DjbnD3WE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSet-CKSmZC_I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utilities.esm-DvrcU9Ky.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/floating-outline-DmCT2Mvg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eye-off-BUwXWtH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/plus-CiGrWbgb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/readonly-python-code-CkaJ4Tks.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-video-camera-BGBfFNDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-text-O5IflCIn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-CqXxt3_J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-BMriRmf-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/label-4Nancvon.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textarea-BnZHy5Jt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/circle-x-Cc9X6U_B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-ccw-aU2rUkrI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-2-Du5ITnDv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/form-600t_Civ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/field-Dov6YyOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/switch-Ct8mUApv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useBoolean-Dmwks1uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeepCompareMemoize-C8RdAYFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-D0WVpW93.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/prop-types-WJwGTMoZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/es-DAmFxw3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/VisuallyHidden-RqykLBKh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseFlatten-rM2FaX4x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hasIn-CE-pxQP-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_basePickBy-LbasZ8ix.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pick-FbHfDtcJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/send-LAFRRDPT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/code-xml-DdSOsi73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-Dmmu2U4a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globe-vMZtva7z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-cw-BOc7UXm9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/settings-DznrHqbd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-DhlBDqyx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/triangle-alert-Bf1kg4xT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DL3W3q-2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/bundle.esm-C-9IAWQU.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-CJU5NUvF.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "01_eda.py",
            "mode": "read",
            "version": "0.18.4",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 12, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "locale": "en-US", "reference_highlighting": true, "theme": "system"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"app_title": "Churn EDA - Data Profiling \u0026 Analysis", "auto_download": ["html"], "css_file": "", "sql_output": "auto", "width": "full"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\"\"\"\n# Churn Prediction: Exploratory Data Analysis\n\nThis notebook provides comprehensive exploration of the churn dataset with:\n\n1. **Data Quality** - Missing values, distributions, correlations\n2. **Customer Segmentation** - Cohort and LTV tier analysis\n3. **Churn Patterns** - Multi-dimensional churn analysis\n4. **Cohort Analysis** - Temporal churn heatmap by signup cohort\n5. **Engagement Insights** - Behavioral patterns of churned vs retained\n6. **Feature Relationships** - Correlation analysis and feature importance\n\"\"\")", "code_hash": "337d454cc3dd4c99605d9dd1ec2d1165", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "import sys\nfrom pathlib import Path\n\n# Get project root relative to this script's location\nPROJECT_ROOT = Path(__file__).parent.parent\nsys.path.insert(0, str(PROJECT_ROOT))\n\nimport numpy as np\nimport pandas as pd\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\n\n# Define consistent color palette\nCOLORS = {\n    \"primary\": \"#1f77b4\",\n    \"secondary\": \"#ff7f0e\",\n    \"success\": \"#2ca02c\",\n    \"danger\": \"#d62728\",\n    \"warning\": \"#bcbd22\",\n    \"info\": \"#17becf\",\n    \"churned\": \"#d62728\",\n    \"retained\": \"#2ca02c\",\n    \"cohort\": {\"new_user\": \"#ff7f0e\", \"established\": \"#2ca02c\", \"mature\": \"#1f77b4\"},\n    \"ltv\": {\"smb\": \"#17becf\", \"mid_market\": \"#bcbd22\", \"enterprise\": \"#9467bd\"},\n}\n\n# Custom Plotly template for consistent styling\nPLOT_TEMPLATE = \"plotly_white\"", "code_hash": "270f4fb8439b76ca0a3e901ecd724fb5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(\"\"\"\n## 1. Load \u0026 Profile Data\n\"\"\")", "code_hash": "98627fb515a81a222d1fe9640f1c9211", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "# Load synthetic data using absolute paths\nDATA_DIR = PROJECT_ROOT / \"outputs\" / \"synthetic_data\"\n\ncustomers = pd.read_parquet(DATA_DIR / \"customers.parquet\")\ndaily_engagement = pd.read_parquet(DATA_DIR / \"daily_engagement.parquet\")\nsupport_tickets = pd.read_parquet(DATA_DIR / \"support_tickets.parquet\")\n\n# Add derived columns for analysis\ncustomers[\"signup_month\"] = pd.to_datetime(customers[\"signup_date\"]).dt.to_period(\"M\").astype(str)\ncustomers[\"churn_month\"] = pd.to_datetime(customers[\"churn_date\"]).dt.to_period(\"M\").astype(str)\ncustomers[\"months_to_churn\"] = (\n    (pd.to_datetime(customers[\"churn_date\"]) - pd.to_datetime(customers[\"signup_date\"])).dt.days / 30\n).round(0)\n\nprint(f\"\u2713 Loaded {len(customers):,} customers\")\nprint(f\"\u2713 Loaded {len(daily_engagement):,} daily engagement records\")\nprint(f\"\u2713 Loaded {len(support_tickets):,} support tickets\")", "code_hash": "6b9952f3be1389a17a53859c46e91232", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "# Interactive controls for data profiling\nshow_distributions = mo.ui.switch(label=\"Show Distribution Charts\", value=True)\npage_size_slider = mo.ui.slider(\n    start=10, stop=100, step=10, value=15, label=\"Rows per page\"\n)\n\nmo.hstack(\n    [\n        mo.md(\"**\ud83d\udccb Data Profiling Controls:**\"),\n        show_distributions,\n        page_size_slider,\n    ],\n    justify=\"start\",\n    gap=2,\n)", "code_hash": "eaa1a64eb08a11d2d4f65c27c55d8002", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "# Define columns: exclude ID columns from default view but include all others\n_id_columns = [\"customer_id\"]\n_profile_columns = [_c for _c in customers.columns if _c not in _id_columns]\n\n# Prepare profiling dataframe with sortable columns\n_profiling_df = customers[_profile_columns].copy()\n\n# Display based on toggle\nif show_distributions.value:\n    _profile_view = mo.ui.table(\n        _profiling_df,\n        pagination=True,\n        page_size=page_size_slider.value,\n        show_column_summaries=\"chart\",\n        show_data_types=True,\n        selection=None,\n        max_columns=None,\n    )\nelse:\n    _profile_view = mo.ui.dataframe(\n        _profiling_df,\n        page_size=page_size_slider.value,\n    )\n\nmo.vstack(\n    [\n        mo.md(\n            f\"**Customer Data Profile** \u2014 {len(_profiling_df):,} rows, \"\n            f\"{len(_profile_columns)} columns \"\n            f\"({'with distributions' if show_distributions.value else 'with transforms'})\"\n        ),\n        _profile_view,\n    ],\n    gap=1,\n)", "code_hash": "526d0ff5ec80ae7b94fdf6d43f2d3fcb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "# Data Quality Summary\nmissing_pct = (customers.isnull().sum() / len(customers) * 100).round(2)\nmissing_cols = missing_pct[missing_pct \u003E 0]\n\nquality_md = f\"\"\"\n### Data Quality Summary\n\n| Metric | Value |\n|--------|-------|\n| Total Records | {len(customers):,} |\n| Total Features | {len(customers.columns)} |\n| Missing Values | {customers.isnull().sum().sum():,} ({(customers.isnull().sum().sum() / customers.size * 100):.2f}%) |\n| Duplicate Rows | {customers.duplicated().sum()} |\n\n**Columns with Missing Values:** {len(missing_cols)} columns\n\"\"\"\nif len(missing_cols) \u003E 0:\n    quality_md += \"\\n| Column | Missing % |\\n|--------|----------|\\n\"\n    for _col, _pct in missing_cols.head(10).items():\n        quality_md += f\"| {_col} | {_pct:.1f}% |\\n\"\n\nmo.md(quality_md)", "code_hash": "a120c833c836a23073d882ad3cb3d9aa", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "mo.md(\"\"\"\n## 2. Customer Segmentation\n\nUnderstanding customer distribution by lifecycle cohort and value tier.\n\"\"\")", "code_hash": "a636768bcde6b8878813fb530efc204b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "# Replace pie charts with Treemap - Hierarchical view of Cohort \u2192 LTV Tier\nsegment_data = customers.groupby([\"cohort\", \"ltv_tier\"]).agg(\n    count=(\"customer_id\", \"count\"),\n    churn_rate=(\"churn_label\", \"mean\"),\n    avg_ltv=(\"estimated_ltv\", \"mean\")\n).reset_index()\n\nsegment_data[\"label\"] = segment_data.apply(\n    lambda r: f\"{r['ltv_tier']}\u003Cbr\u003E{r['count']:,} customers\u003Cbr\u003EChurn: {r['churn_rate']:.1%}\",\n    axis=1\n)\n\nfig_treemap = px.treemap(\n    segment_data,\n    path=[\"cohort\", \"ltv_tier\"],\n    values=\"count\",\n    color=\"churn_rate\",\n    color_continuous_scale=[\"#2ca02c\", \"#bcbd22\", \"#ff7f0e\", \"#d62728\"],\n    color_continuous_midpoint=segment_data[\"churn_rate\"].mean(),\n    title=\"Customer Segmentation: Cohort \u2192 LTV Tier (Color = Churn Rate)\",\n    hover_data={\"churn_rate\": \":.1%\", \"avg_ltv\": \":$,.0f\", \"count\": \":,\"},\n    template=PLOT_TEMPLATE,\n)\n\nfig_treemap.update_layout(\n    height=500,\n    coloraxis_colorbar={\"title\": \"Churn Rate\", \"tickformat\": \".0%\"},\n)\nfig_treemap  # noqa: B018", "code_hash": "f8b73ae207104ef6e5db699bdb84de43", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "# Horizontal stacked bar chart - replaces pie charts with more readable format\ncohort_ltv = customers.groupby([\"cohort\", \"ltv_tier\"]).size().unstack(fill_value=0)\n\nfig_stacked = make_subplots(\n    rows=1, cols=2,\n    subplot_titles=(\"Customers by Cohort \u0026 LTV Tier\", \"Churn Rate by Segment\"),\n    horizontal_spacing=0.15,\n)\n\n# Stacked bar for customer counts\nfor _i, ltv in enumerate(cohort_ltv.columns):\n    fig_stacked.add_trace(\n        go.Bar(\n            name=ltv,\n            y=cohort_ltv.index,\n            x=cohort_ltv[ltv],\n            orientation=\"h\",\n            marker_color=COLORS[\"ltv\"].get(ltv, \"#888\"),\n            text=cohort_ltv[ltv],\n            textposition=\"inside\",\n        ),\n        row=1, col=1\n    )\n\n# Churn rate by cohort\nchurn_by_cohort = customers.groupby(\"cohort\")[\"churn_label\"].mean().sort_values(ascending=True)\nfig_stacked.add_trace(\n    go.Bar(\n        name=\"Churn Rate\",\n        y=churn_by_cohort.index,\n        x=churn_by_cohort.values,\n        orientation=\"h\",\n        marker_color=[COLORS[\"cohort\"].get(c, \"#888\") for c in churn_by_cohort.index],\n        text=[f\"{v:.1%}\" for v in churn_by_cohort.values],\n        textposition=\"outside\",\n        showlegend=False,\n    ),\n    row=1, col=2\n)\n\nfig_stacked.update_layout(\n    barmode=\"stack\",\n    height=400,\n    title=\"Customer Distribution \u0026 Churn by Segment\",\n    template=PLOT_TEMPLATE,\n)\nfig_stacked.update_xaxes(title_text=\"Customer Count\", row=1, col=1)\nfig_stacked.update_xaxes(title_text=\"Churn Rate\", tickformat=\".0%\", row=1, col=2)\nfig_stacked  # noqa: B018", "code_hash": "496906c559d68ef2ac6d5e7819e64db9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.md(\"\"\"\n## 3. Multi-Dimensional Churn Analysis\n\nExamining churn rates across multiple dimensions simultaneously.\n\"\"\")", "code_hash": "a2b47a4c0c65e37bd7b2dd152f998de4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "# Multi-dimensional churn analysis - grouped bar chart with faceting\n_churn_multi = customers.groupby([\"cohort\", \"ltv_tier\", \"contract_type\"]).agg(\n    total=(\"customer_id\", \"count\"),\n    churned=(\"churn_label\", \"sum\"),\n    churn_rate=(\"churn_label\", \"mean\"),\n).reset_index()\n\n# Overall churn rate for reference line\noverall_churn = customers[\"churn_label\"].mean()\n\n# Create faceted bar chart by contract type\n_fig_multi = make_subplots(\n    rows=1, cols=3,\n    subplot_titles=[\"Month-to-month\", \"One year\", \"Two year\"],\n    shared_yaxes=True,\n    horizontal_spacing=0.05,\n)\n\n_contract_types = [\"Month-to-month\", \"One year\", \"Two year\"]\n\nfor _i, _contract in enumerate(_contract_types, 1):\n    _contract_data = _churn_multi[_churn_multi[\"contract_type\"] == _contract]\n\n    for _cohort in [\"new_user\", \"established\", \"mature\"]:\n        _cohort_data = _contract_data[_contract_data[\"cohort\"] == _cohort]\n        if len(_cohort_data) \u003E 0:\n            _fig_multi.add_trace(\n                go.Bar(\n                    name=_cohort if _i == 1 else None,\n                    x=_cohort_data[\"ltv_tier\"],\n                    y=_cohort_data[\"churn_rate\"],\n                    marker_color=COLORS[\"cohort\"].get(_cohort, \"#888\"),\n                    text=[f\"{v:.1%}\" for v in _cohort_data[\"churn_rate\"]],\n                    textposition=\"outside\",\n                    legendgroup=_cohort,\n                    showlegend=(_i == 1),\n                ),\n                row=1, col=_i\n            )\n\n    # Add reference line for overall churn\n    _fig_multi.add_hline(\n        y=overall_churn, line_dash=\"dash\", line_color=\"gray\",\n        annotation_text=f\"Avg: {overall_churn:.1%}\" if _i == 3 else None,\n        row=1, col=_i\n    )\n\n_fig_multi.update_layout(\n    barmode=\"group\",\n    height=450,\n    title=\"\ud83d\udcca Churn Rate by Cohort \u00d7 LTV Tier \u00d7 Contract Type\",\n    template=PLOT_TEMPLATE,\n    legend_title=\"Cohort\",\n)\n_fig_multi.update_yaxes(tickformat=\".0%\", range=[0, min(_churn_multi[\"churn_rate\"].max() * 1.3, 1)])\n_fig_multi  # noqa: B018", "code_hash": "8c5926c45969aee4bcc245a94cccdfa7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "# Diverging bar chart - churn rate relative to average\nchurn_segments = customers.groupby([\"cohort\", \"ltv_tier\"]).agg(\n    churn_rate=(\"churn_label\", \"mean\"),\n    count=(\"customer_id\", \"count\")\n).reset_index()\n\nchurn_segments[\"segment\"] = churn_segments[\"cohort\"] + \" / \" + churn_segments[\"ltv_tier\"]\nchurn_segments[\"deviation\"] = churn_segments[\"churn_rate\"] - overall_churn\nchurn_segments = churn_segments.sort_values(\"deviation\")\n\n# Create diverging bar chart\nfig_diverging = go.Figure()\n\nfig_diverging.add_trace(go.Bar(\n    y=churn_segments[\"segment\"],\n    x=churn_segments[\"deviation\"],\n    orientation=\"h\",\n    marker_color=[\n        \"#d62728\" if d \u003E 0 else \"#2ca02c\"\n        for d in churn_segments[\"deviation\"]\n    ],\n    text=[f\"{d:+.1%}\" for d in churn_segments[\"deviation\"]],\n    textposition=\"outside\",\n    hovertemplate=\"\u003Cb\u003E%{y}\u003C/b\u003E\u003Cbr\u003EDeviation: %{x:.1%}\u003Cbr\u003EChurn Rate: %{customdata:.1%}\u003Cextra\u003E\u003C/extra\u003E\",\n    customdata=churn_segments[\"churn_rate\"],\n))\n\nfig_diverging.add_vline(x=0, line_dash=\"solid\", line_color=\"gray\", line_width=2)\n\nfig_diverging.update_layout(\n    title=f\"\ud83d\udcc8 Churn Rate Deviation from Average ({overall_churn:.1%})\",\n    xaxis_title=\"Deviation from Average Churn Rate\",\n    yaxis_title=\"Customer Segment\",\n    height=400,\n    template=PLOT_TEMPLATE,\n    xaxis_tickformat=\"+.1%\",\n)\nfig_diverging  # noqa: B018", "code_hash": "a5025399096eb40a436e96cd8f3f25a5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\"\"\"\n## 4. Cohort Churn Heatmap\n\nVisualizing churn patterns by signup month and customer age (months since signup).\n\"\"\")", "code_hash": "b45b12a31fabc640bd337a70cacafbee", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "# Build cohort heatmap data\n# X-axis: Signup month (calendar month)\n# Y-axis: Month number (months since signup when churn occurred)\n\n# Create cohort analysis data\ncohort_data = []\nfor signup_month in customers[\"signup_month\"].unique():\n    month_customers = customers[customers[\"signup_month\"] == signup_month]\n    total_in_cohort = len(month_customers)\n\n    for months_since in range(0, 13):  # 0-12 months\n        churned_in_month = len(\n            month_customers[\n                (month_customers[\"churn_label\"]) \u0026\n                (month_customers[\"months_to_churn\"] \u003E= months_since) \u0026\n                (month_customers[\"months_to_churn\"] \u003C months_since + 1)\n            ]\n        )\n        churn_rate = churned_in_month / total_in_cohort if total_in_cohort \u003E 0 else 0\n\n        cohort_data.append({\n            \"signup_month\": signup_month,\n            \"months_since_signup\": f\"Month {months_since}\",\n            \"churn_rate\": churn_rate,\n            \"churned_count\": churned_in_month,\n            \"cohort_size\": total_in_cohort,\n        })\n\ncohort_df = pd.DataFrame(cohort_data)\n\n# Pivot for heatmap\nheatmap_data = cohort_df.pivot(\n    index=\"months_since_signup\",\n    columns=\"signup_month\",\n    values=\"churn_rate\"\n).fillna(0)\n\n# Sort columns by date\nheatmap_data = heatmap_data[sorted(heatmap_data.columns)]\n\n# Create heatmap\nfig_heatmap = go.Figure(data=go.Heatmap(\n    z=heatmap_data.values,\n    x=heatmap_data.columns,\n    y=heatmap_data.index,\n    colorscale=[\n        [0, \"#1a9850\"],      # Low churn - green\n        [0.25, \"#91cf60\"],\n        [0.5, \"#ffffbf\"],    # Medium - yellow\n        [0.75, \"#fc8d59\"],\n        [1, \"#d73027\"],      # High churn - red\n    ],\n    colorbar={\"title\": \"Churn Rate\", \"tickformat\": \".1%\"},\n    hovertemplate=\"Signup: %{x}\u003Cbr\u003E%{y}\u003Cbr\u003EChurn Rate: %{z:.2%}\u003Cextra\u003E\u003C/extra\u003E\",\n))\n\nfig_heatmap.update_layout(\n    title=\"Cohort Churn Heatmap: When Do Customers Churn?\",\n    xaxis_title=\"Signup Month (Cohort)\",\n    yaxis_title=\"Months Since Signup\",\n    height=500,\n    template=PLOT_TEMPLATE,\n    yaxis={\"autorange\": \"reversed\"},  # Month 0 at top\n)\n\n# Add annotations for high-churn cells\nfor _i, _row in enumerate(heatmap_data.index):\n    for _j, _col in enumerate(heatmap_data.columns):\n        _val = heatmap_data.loc[_row, _col]\n        if _val \u003E 0.02:  # Only annotate significant churn\n            fig_heatmap.add_annotation(\n                x=_col, y=_row,\n                text=f\"{_val:.1%}\",\n                showarrow=False,\n                font={\"size\": 8, \"color\": \"white\" if _val \u003E 0.03 else \"black\"},\n            )\n\nfig_heatmap  # noqa: B018", "code_hash": "029d4fe34c2190b77e08f455e3623fcf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "# Aggregate cohort trends - line chart showing churn by month since signup\ncohort_trend = cohort_df.groupby(\"months_since_signup\").agg(\n    avg_churn_rate=(\"churn_rate\", \"mean\"),\n    total_churned=(\"churned_count\", \"sum\"),\n).reset_index()\n\nfig_cohort_trend = px.line(\n    cohort_trend,\n    x=\"months_since_signup\",\n    y=\"avg_churn_rate\",\n    markers=True,\n    title=\"Average Churn Rate by Months Since Signup\",\n    labels={\"avg_churn_rate\": \"Churn Rate\", \"months_since_signup\": \"Months Since Signup\"},\n    template=PLOT_TEMPLATE,\n)\n\nfig_cohort_trend.update_traces(\n    line={\"color\": COLORS[\"danger\"], \"width\": 3},\n    marker={\"size\": 10},\n)\n\nfig_cohort_trend.update_layout(\n    height=350,\n    yaxis_tickformat=\".1%\",\n)\nfig_cohort_trend  # noqa: B018", "code_hash": "d1b482b088b2c1a501b91a891f620e9e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "mo.md(\"\"\"\n## 5. Engagement Analysis\n\nComparing behavioral patterns between churned and retained customers.\n\"\"\")", "code_hash": "39ecf143500e8bf32342382ada4e27c2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "# Merge engagement with customer info\nengagement_with_churn = daily_engagement.merge(\n    customers[[\"customer_id\", \"churn_label\", \"cohort\", \"ltv_tier\"]],\n    on=\"customer_id\"\n)\n\n# Calculate customer-level engagement metrics\ncustomer_engagement = engagement_with_churn.groupby([\"customer_id\", \"churn_label\"]).agg(\n    avg_logins=(\"login_count\", \"mean\"),\n    avg_features=(\"features_used\", \"mean\"),\n    avg_session=(\"session_duration_minutes\", \"mean\"),\n    total_days=(\"login_count\", \"count\"),\n).reset_index()\n\ncustomer_engagement[\"churn_status\"] = customer_engagement[\"churn_label\"].map(\n    {True: \"Churned\", False: \"Retained\"}\n)\n\n# Create box plots for engagement comparison\nfig_engagement = make_subplots(\n    rows=1, cols=3,\n    subplot_titles=[\"Avg Daily Logins\", \"Avg Features Used\", \"Avg Session Duration (min)\"],\n    horizontal_spacing=0.08,\n)\n\nfor _i, (_col, _title) in enumerate([\n    (\"avg_logins\", \"Logins\"),\n    (\"avg_features\", \"Features\"),\n    (\"avg_session\", \"Session Duration\")\n], 1):\n    for _status in [\"Retained\", \"Churned\"]:\n        _data = customer_engagement[customer_engagement[\"churn_status\"] == _status][_col]\n        fig_engagement.add_trace(\n            go.Box(\n                y=_data,\n                name=_status,\n                marker_color=COLORS[\"retained\"] if _status == \"Retained\" else COLORS[\"churned\"],\n                legendgroup=_status,\n                showlegend=(_i == 1),\n                boxmean=True,\n            ),\n            row=1, col=_i\n        )\n\nfig_engagement.update_layout(\n    title=\"Engagement Distribution: Churned vs Retained Customers\",\n    height=450,\n    template=PLOT_TEMPLATE,\n    boxmode=\"group\",\n)\nfig_engagement  # noqa: B018", "code_hash": "bc9ff36453d40906a5cfe50557540500", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "# Violin plots for richer distribution view\nfig_violin = make_subplots(\n    rows=1, cols=3,\n    subplot_titles=[\"Avg Daily Logins\", \"Avg Features Used\", \"Avg Session Duration\"],\n    horizontal_spacing=0.08,\n)\n\nfor _i, _col in enumerate([\"avg_logins\", \"avg_features\", \"avg_session\"], 1):\n    for _status in [\"Retained\", \"Churned\"]:\n        _data = customer_engagement[customer_engagement[\"churn_status\"] == _status][_col]\n        fig_violin.add_trace(\n            go.Violin(\n                y=_data,\n                name=_status,\n                side=\"positive\" if _status == \"Retained\" else \"negative\",\n                marker_color=COLORS[\"retained\"] if _status == \"Retained\" else COLORS[\"churned\"],\n                legendgroup=_status,\n                showlegend=(_i == 1),\n                meanline_visible=True,\n                box_visible=True,\n            ),\n            row=1, col=_i\n        )\n\nfig_violin.update_layout(\n    title=\"Engagement Distribution (Violin Plot) - Churned vs Retained\",\n    height=400,\n    template=PLOT_TEMPLATE,\n    violinmode=\"overlay\",\n)\nfig_violin  # noqa: B018", "code_hash": "b5c81e018a3ae247db6a1d40813648f5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(\"\"\"\n## 6. Feature Correlations\n\nUnderstanding relationships between key features and churn.\n\"\"\")", "code_hash": "febb1451b8f485ea0a3c6f506cdb65fe", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "# Select numeric columns for correlation analysis\nnumeric_cols = [\n    \"tenure_days\", \"monthly_charges\", \"estimated_ltv\",\n    \"churn_label\"\n]\n\n# Add available engagement-related columns if they exist\nfor _c in [\"n_addon_services\"]:\n    if _c in customers.columns:\n        numeric_cols.append(_c)\n\ncorr_matrix = customers[numeric_cols].corr()\n\n# Create correlation heatmap\nfig_corr = go.Figure(data=go.Heatmap(\n    z=corr_matrix.values,\n    x=corr_matrix.columns,\n    y=corr_matrix.index,\n    colorscale=\"RdBu_r\",\n    zmid=0,\n    text=np.round(corr_matrix.values, 2),\n    texttemplate=\"%{text}\",\n    textfont={\"size\": 10},\n    colorbar={\"title\": \"Correlation\"},\n))\n\nfig_corr.update_layout(\n    title=\"Feature Correlation Matrix\",\n    height=450,\n    template=PLOT_TEMPLATE,\n    xaxis={\"tickangle\": 45},\n)\nfig_corr  # noqa: B018", "code_hash": "63b0dbdca9055fea044ee28aeda79557", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "# Feature importance for churn - bar chart of correlations with churn_label\nnumeric_features = customers.select_dtypes(include=[\"number\"]).columns.tolist()\nexclude = [\"churn_label\", \"customer_id\"]\nnumeric_features = [f for f in numeric_features if f not in exclude and not f.endswith(\"_id\")]\n\ncorrelations = []\nfor _feat in numeric_features:\n    if _feat in customers.columns:\n        _corr = customers[_feat].corr(customers[\"churn_label\"])\n        if not np.isnan(_corr):\n            correlations.append({\"feature\": _feat, \"correlation\": _corr})\n\ncorr_df = pd.DataFrame(correlations).sort_values(\"correlation\", key=abs, ascending=True)\n\nfig_feature_corr = go.Figure()\n\nfig_feature_corr.add_trace(go.Bar(\n    y=corr_df[\"feature\"],\n    x=corr_df[\"correlation\"],\n    orientation=\"h\",\n    marker_color=[COLORS[\"danger\"] if c \u003E 0 else COLORS[\"success\"] for c in corr_df[\"correlation\"]],\n    text=[f\"{c:+.3f}\" for c in corr_df[\"correlation\"]],\n    textposition=\"outside\",\n))\n\nfig_feature_corr.add_vline(x=0, line_color=\"gray\", line_width=2)\n\nfig_feature_corr.update_layout(\n    title=\"Feature Correlation with Churn\",\n    xaxis_title=\"Correlation Coefficient\",\n    yaxis_title=\"Feature\",\n    height=max(400, len(corr_df) * 25),\n    template=PLOT_TEMPLATE,\n)\nfig_feature_corr  # noqa: B018", "code_hash": "d5a4eb6cb86267a04900f87ac40817c6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "mo.md(\"\"\"\n## 7. Summary \u0026 Key Insights\n\"\"\")", "code_hash": "6260cbe738af64b0ed5a92af7b538c8d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "# Calculate key statistics\nchurn_by_cohort_summary = customers.groupby(\"cohort\")[\"churn_label\"].mean()\nchurn_by_contract_summary = customers.groupby(\"contract_type\")[\"churn_label\"].mean()\nchurn_by_ltv_summary = customers.groupby(\"ltv_tier\")[\"churn_label\"].mean()\n\nhighest_churn_cohort = churn_by_cohort_summary.idxmax()\nhighest_churn_contract = churn_by_contract_summary.idxmax()\n\nsummary = f\"\"\"\n### Dataset Summary\n\n| Metric | Value |\n|--------|-------|\n| **Total Customers** | {len(customers):,} |\n| **Overall Churn Rate** | {overall_churn:.1%} |\n| **Avg Monthly Revenue** | ${customers['monthly_charges'].mean():,.0f} |\n| **Avg Estimated LTV** | ${customers['estimated_ltv'].mean():,.0f} |\n| **Date Range** | {customers['signup_month'].min()} to {customers['signup_month'].max()} |\n\n### Churn Rate by Segment\n\n| Cohort | Churn Rate | | LTV Tier | Churn Rate |\n|--------|------------|---|----------|------------|\n| New User | {churn_by_cohort_summary.get('new_user', 0):.1%} | | SMB | {churn_by_ltv_summary.get('smb', 0):.1%} |\n| Established | {churn_by_cohort_summary.get('established', 0):.1%} | | Mid-Market | {churn_by_ltv_summary.get('mid_market', 0):.1%} |\n| Mature | {churn_by_cohort_summary.get('mature', 0):.1%} | | Enterprise | {churn_by_ltv_summary.get('enterprise', 0):.1%} |\n\n### Key Insights\n\n1. ** Highest Risk:** `{highest_churn_cohort}` cohort with `{highest_churn_contract}` contracts\n2. ** Early Churn:** Most churn occurs in first 3 months (see cohort heatmap)\n3. ** Engagement Signal:** Churners show significantly lower engagement metrics\n4. ** LTV Paradox:** Enterprise customers churn less but each loss is high-impact\n5. ** Contract Lock-in:** Annual/biennial contracts reduce churn substantially\n\n### Next Steps\n\n- **Feature Engineering:** Create velocity features from engagement trends\n- **Cohort-Specific Models:** Consider separate models for new vs established users\n- **Intervention Timing:** Focus retention efforts in months 1-3\n- **Contract Strategy:** Incentivize longer contract terms for high-risk segments\n\"\"\"\n\nmo.md(summary)", "code_hash": "d210e6289fe9d02ee71c1fa8623ffdb6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "session": {"cells": [{"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "Hbol", "outputs": []}, {"code_hash": "337d454cc3dd4c99605d9dd1ec2d1165", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"churn-prediction-exploratory-data-analysis\"\u003EChurn Prediction: Exploratory Data Analysis\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EThis notebook provides comprehensive exploration of the churn dataset with:\u003C/span\u003E\n\u003Col\u003E\n\u003Cli\u003E\u003Cstrong\u003EData Quality\u003C/strong\u003E - Missing values, distributions, correlations\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ECustomer Segmentation\u003C/strong\u003E - Cohort and LTV tier analysis\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EChurn Patterns\u003C/strong\u003E - Multi-dimensional churn analysis\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ECohort Analysis\u003C/strong\u003E - Temporal churn heatmap by signup cohort\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EEngagement Insights\u003C/strong\u003E - Behavioral patterns of churned vs retained\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EFeature Relationships\u003C/strong\u003E - Correlation analysis and feature importance\u003C/li\u003E\n\u003C/ol\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "270f4fb8439b76ca0a3e901ecd724fb5", "console": [], "id": "vblA", "outputs": []}, {"code_hash": "98627fb515a81a222d1fe9640f1c9211", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"1-load-profile-data\"\u003E1. Load \u0026amp; Profile Data\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6b9952f3be1389a17a53859c46e91232", "console": [], "id": "lEQa", "outputs": []}, {"code_hash": "eaa1a64eb08a11d2d4f65c27c55d8002", "console": [], "id": "PKri", "outputs": []}, {"code_hash": "526d0ff5ec80ae7b94fdf6d43f2d3fcb", "console": [], "id": "Xref", "outputs": []}, {"code_hash": "a120c833c836a23073d882ad3cb3d9aa", "console": [], "id": "SFPL", "outputs": []}, {"code_hash": "a636768bcde6b8878813fb530efc204b", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"2-customer-segmentation\"\u003E2. Customer Segmentation\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EUnderstanding customer distribution by lifecycle cohort and value tier.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f8b73ae207104ef6e5db699bdb84de43", "console": [], "id": "RGSE", "outputs": []}, {"code_hash": "496906c559d68ef2ac6d5e7819e64db9", "console": [], "id": "Kclp", "outputs": []}, {"code_hash": "a2b47a4c0c65e37bd7b2dd152f998de4", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"3-multi-dimensional-churn-analysis\"\u003E3. Multi-Dimensional Churn Analysis\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EExamining churn rates across multiple dimensions simultaneously.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "8c5926c45969aee4bcc245a94cccdfa7", "console": [], "id": "Hstk", "outputs": []}, {"code_hash": "a5025399096eb40a436e96cd8f3f25a5", "console": [], "id": "nWHF", "outputs": []}, {"code_hash": "b45b12a31fabc640bd337a70cacafbee", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"4-cohort-churn-heatmap\"\u003E4. Cohort Churn Heatmap\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EVisualizing churn patterns by signup month and customer age (months since signup).\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "029d4fe34c2190b77e08f455e3623fcf", "console": [], "id": "ZHCJ", "outputs": []}, {"code_hash": "d1b482b088b2c1a501b91a891f620e9e", "console": [], "id": "ROlb", "outputs": []}, {"code_hash": "39ecf143500e8bf32342382ada4e27c2", "console": [], "id": "qnkX", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"5-engagement-analysis\"\u003E5. Engagement Analysis\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EComparing behavioral patterns between churned and retained customers.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "bc9ff36453d40906a5cfe50557540500", "console": [], "id": "TqIu", "outputs": []}, {"code_hash": "b5c81e018a3ae247db6a1d40813648f5", "console": [], "id": "Vxnm", "outputs": []}, {"code_hash": "febb1451b8f485ea0a3c6f506cdb65fe", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"6-feature-correlations\"\u003E6. Feature Correlations\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EUnderstanding relationships between key features and churn.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "63b0dbdca9055fea044ee28aeda79557", "console": [], "id": "ulZA", "outputs": []}, {"code_hash": "d5a4eb6cb86267a04900f87ac40817c6", "console": [], "id": "ecfG", "outputs": []}, {"code_hash": "6260cbe738af64b0ed5a92af7b538c8d", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"7-summary-key-insights\"\u003E7. Summary \u0026amp; Key Insights\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d210e6289fe9d02ee71c1fa8623ffdb6", "console": [], "id": "ZBYS", "outputs": []}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.4%22%0Aapp%20%3D%20marimo.App(%0A%20%20%20%20width%3D%22full%22%2C%0A%20%20%20%20app_title%3D%22Churn%20EDA%20-%20Data%20Profiling%20%26%20Analysis%22%2C%0A%20%20%20%20css_file%3D%22%22%2C%0A%20%20%20%20auto_download%3D%5B%22html%22%5D%2C%0A)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%20Churn%20Prediction%3A%20Exploratory%20Data%20Analysis%0A%0A%20%20%20%20This%20notebook%20provides%20comprehensive%20exploration%20of%20the%20churn%20dataset%20with%3A%0A%0A%20%20%20%201.%20**Data%20Quality**%20-%20Missing%20values%2C%20distributions%2C%20correlations%0A%20%20%20%202.%20**Customer%20Segmentation**%20-%20Cohort%20and%20LTV%20tier%20analysis%0A%20%20%20%203.%20**Churn%20Patterns**%20-%20Multi-dimensional%20churn%20analysis%0A%20%20%20%204.%20**Cohort%20Analysis**%20-%20Temporal%20churn%20heatmap%20by%20signup%20cohort%0A%20%20%20%205.%20**Engagement%20Insights**%20-%20Behavioral%20patterns%20of%20churned%20vs%20retained%0A%20%20%20%206.%20**Feature%20Relationships**%20-%20Correlation%20analysis%20and%20feature%20importance%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20sys%0A%20%20%20%20from%20pathlib%20import%20Path%0A%0A%20%20%20%20%23%20Get%20project%20root%20relative%20to%20this%20script's%20location%0A%20%20%20%20PROJECT_ROOT%20%3D%20Path(__file__).parent.parent%0A%20%20%20%20sys.path.insert(0%2C%20str(PROJECT_ROOT))%0A%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20plotly.express%20as%20px%0A%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%20%20%20%20from%20plotly.subplots%20import%20make_subplots%0A%0A%20%20%20%20%23%20Define%20consistent%20color%20palette%0A%20%20%20%20COLORS%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22primary%22%3A%20%22%231f77b4%22%2C%0A%20%20%20%20%20%20%20%20%22secondary%22%3A%20%22%23ff7f0e%22%2C%0A%20%20%20%20%20%20%20%20%22success%22%3A%20%22%232ca02c%22%2C%0A%20%20%20%20%20%20%20%20%22danger%22%3A%20%22%23d62728%22%2C%0A%20%20%20%20%20%20%20%20%22warning%22%3A%20%22%23bcbd22%22%2C%0A%20%20%20%20%20%20%20%20%22info%22%3A%20%22%2317becf%22%2C%0A%20%20%20%20%20%20%20%20%22churned%22%3A%20%22%23d62728%22%2C%0A%20%20%20%20%20%20%20%20%22retained%22%3A%20%22%232ca02c%22%2C%0A%20%20%20%20%20%20%20%20%22cohort%22%3A%20%7B%22new_user%22%3A%20%22%23ff7f0e%22%2C%20%22established%22%3A%20%22%232ca02c%22%2C%20%22mature%22%3A%20%22%231f77b4%22%7D%2C%0A%20%20%20%20%20%20%20%20%22ltv%22%3A%20%7B%22smb%22%3A%20%22%2317becf%22%2C%20%22mid_market%22%3A%20%22%23bcbd22%22%2C%20%22enterprise%22%3A%20%22%239467bd%22%7D%2C%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%20Custom%20Plotly%20template%20for%20consistent%20styling%0A%20%20%20%20PLOT_TEMPLATE%20%3D%20%22plotly_white%22%0A%20%20%20%20return%20COLORS%2C%20PLOT_TEMPLATE%2C%20PROJECT_ROOT%2C%20go%2C%20make_subplots%2C%20np%2C%20pd%2C%20px%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%201.%20Load%20%26%20Profile%20Data%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(PROJECT_ROOT%2C%20pd)%3A%0A%20%20%20%20%23%20Load%20synthetic%20data%20using%20absolute%20paths%0A%20%20%20%20DATA_DIR%20%3D%20PROJECT_ROOT%20%2F%20%22outputs%22%20%2F%20%22synthetic_data%22%0A%0A%20%20%20%20customers%20%3D%20pd.read_parquet(DATA_DIR%20%2F%20%22customers.parquet%22)%0A%20%20%20%20daily_engagement%20%3D%20pd.read_parquet(DATA_DIR%20%2F%20%22daily_engagement.parquet%22)%0A%20%20%20%20support_tickets%20%3D%20pd.read_parquet(DATA_DIR%20%2F%20%22support_tickets.parquet%22)%0A%0A%20%20%20%20%23%20Add%20derived%20columns%20for%20analysis%0A%20%20%20%20customers%5B%22signup_month%22%5D%20%3D%20pd.to_datetime(customers%5B%22signup_date%22%5D).dt.to_period(%22M%22).astype(str)%0A%20%20%20%20customers%5B%22churn_month%22%5D%20%3D%20pd.to_datetime(customers%5B%22churn_date%22%5D).dt.to_period(%22M%22).astype(str)%0A%20%20%20%20customers%5B%22months_to_churn%22%5D%20%3D%20(%0A%20%20%20%20%20%20%20%20(pd.to_datetime(customers%5B%22churn_date%22%5D)%20-%20pd.to_datetime(customers%5B%22signup_date%22%5D)).dt.days%20%2F%2030%0A%20%20%20%20).round(0)%0A%0A%20%20%20%20print(f%22%E2%9C%93%20Loaded%20%7Blen(customers)%3A%2C%7D%20customers%22)%0A%20%20%20%20print(f%22%E2%9C%93%20Loaded%20%7Blen(daily_engagement)%3A%2C%7D%20daily%20engagement%20records%22)%0A%20%20%20%20print(f%22%E2%9C%93%20Loaded%20%7Blen(support_tickets)%3A%2C%7D%20support%20tickets%22)%0A%20%20%20%20return%20customers%2C%20daily_engagement%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20Interactive%20controls%20for%20data%20profiling%0A%20%20%20%20show_distributions%20%3D%20mo.ui.switch(label%3D%22Show%20Distribution%20Charts%22%2C%20value%3DTrue)%0A%20%20%20%20page_size_slider%20%3D%20mo.ui.slider(%0A%20%20%20%20%20%20%20%20start%3D10%2C%20stop%3D100%2C%20step%3D10%2C%20value%3D15%2C%20label%3D%22Rows%20per%20page%22%0A%20%20%20%20)%0A%0A%20%20%20%20mo.hstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22**%F0%9F%93%8B%20Data%20Profiling%20Controls%3A**%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20show_distributions%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20page_size_slider%2C%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20justify%3D%22start%22%2C%0A%20%20%20%20%20%20%20%20gap%3D2%2C%0A%20%20%20%20)%0A%20%20%20%20return%20page_size_slider%2C%20show_distributions%0A%0A%0A%40app.cell%0Adef%20_(customers%2C%20mo%2C%20page_size_slider%2C%20show_distributions)%3A%0A%20%20%20%20%23%20Define%20columns%3A%20exclude%20ID%20columns%20from%20default%20view%20but%20include%20all%20others%0A%20%20%20%20_id_columns%20%3D%20%5B%22customer_id%22%5D%0A%20%20%20%20_profile_columns%20%3D%20%5B_c%20for%20_c%20in%20customers.columns%20if%20_c%20not%20in%20_id_columns%5D%0A%0A%20%20%20%20%23%20Prepare%20profiling%20dataframe%20with%20sortable%20columns%0A%20%20%20%20_profiling_df%20%3D%20customers%5B_profile_columns%5D.copy()%0A%0A%20%20%20%20%23%20Display%20based%20on%20toggle%0A%20%20%20%20if%20show_distributions.value%3A%0A%20%20%20%20%20%20%20%20_profile_view%20%3D%20mo.ui.table(%0A%20%20%20%20%20%20%20%20%20%20%20%20_profiling_df%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pagination%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20page_size%3Dpage_size_slider.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20show_column_summaries%3D%22chart%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20show_data_types%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20selection%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20max_columns%3DNone%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20_profile_view%20%3D%20mo.ui.dataframe(%0A%20%20%20%20%20%20%20%20%20%20%20%20_profiling_df%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20page_size%3Dpage_size_slider.value%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22**Customer%20Data%20Profile**%20%E2%80%94%20%7Blen(_profiling_df)%3A%2C%7D%20rows%2C%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%7Blen(_profile_columns)%7D%20columns%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22(%7B'with%20distributions'%20if%20show_distributions.value%20else%20'with%20transforms'%7D)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20_profile_view%2C%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20gap%3D1%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(customers%2C%20mo)%3A%0A%20%20%20%20%23%20Data%20Quality%20Summary%0A%20%20%20%20missing_pct%20%3D%20(customers.isnull().sum()%20%2F%20len(customers)%20*%20100).round(2)%0A%20%20%20%20missing_cols%20%3D%20missing_pct%5Bmissing_pct%20%3E%200%5D%0A%0A%20%20%20%20quality_md%20%3D%20f%22%22%22%0A%20%20%20%20%23%23%23%20Data%20Quality%20Summary%0A%0A%20%20%20%20%7C%20Metric%20%7C%20Value%20%7C%0A%20%20%20%20%7C--------%7C-------%7C%0A%20%20%20%20%7C%20Total%20Records%20%7C%20%7Blen(customers)%3A%2C%7D%20%7C%0A%20%20%20%20%7C%20Total%20Features%20%7C%20%7Blen(customers.columns)%7D%20%7C%0A%20%20%20%20%7C%20Missing%20Values%20%7C%20%7Bcustomers.isnull().sum().sum()%3A%2C%7D%20(%7B(customers.isnull().sum().sum()%20%2F%20customers.size%20*%20100)%3A.2f%7D%25)%20%7C%0A%20%20%20%20%7C%20Duplicate%20Rows%20%7C%20%7Bcustomers.duplicated().sum()%7D%20%7C%0A%0A%20%20%20%20**Columns%20with%20Missing%20Values%3A**%20%7Blen(missing_cols)%7D%20columns%0A%20%20%20%20%22%22%22%0A%20%20%20%20if%20len(missing_cols)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20quality_md%20%2B%3D%20%22%5Cn%7C%20Column%20%7C%20Missing%20%25%20%7C%5Cn%7C--------%7C----------%7C%5Cn%22%0A%20%20%20%20%20%20%20%20for%20_col%2C%20_pct%20in%20missing_cols.head(10).items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20quality_md%20%2B%3D%20f%22%7C%20%7B_col%7D%20%7C%20%7B_pct%3A.1f%7D%25%20%7C%5Cn%22%0A%0A%20%20%20%20mo.md(quality_md)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%202.%20Customer%20Segmentation%0A%0A%20%20%20%20Understanding%20customer%20distribution%20by%20lifecycle%20cohort%20and%20value%20tier.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(PLOT_TEMPLATE%2C%20customers%2C%20px)%3A%0A%20%20%20%20%23%20Replace%20pie%20charts%20with%20Treemap%20-%20Hierarchical%20view%20of%20Cohort%20%E2%86%92%20LTV%20Tier%0A%20%20%20%20segment_data%20%3D%20customers.groupby(%5B%22cohort%22%2C%20%22ltv_tier%22%5D).agg(%0A%20%20%20%20%20%20%20%20count%3D(%22customer_id%22%2C%20%22count%22)%2C%0A%20%20%20%20%20%20%20%20churn_rate%3D(%22churn_label%22%2C%20%22mean%22)%2C%0A%20%20%20%20%20%20%20%20avg_ltv%3D(%22estimated_ltv%22%2C%20%22mean%22)%0A%20%20%20%20).reset_index()%0A%0A%20%20%20%20segment_data%5B%22label%22%5D%20%3D%20segment_data.apply(%0A%20%20%20%20%20%20%20%20lambda%20r%3A%20f%22%7Br%5B'ltv_tier'%5D%7D%3Cbr%3E%7Br%5B'count'%5D%3A%2C%7D%20customers%3Cbr%3EChurn%3A%20%7Br%5B'churn_rate'%5D%3A.1%25%7D%22%2C%0A%20%20%20%20%20%20%20%20axis%3D1%0A%20%20%20%20)%0A%0A%20%20%20%20fig_treemap%20%3D%20px.treemap(%0A%20%20%20%20%20%20%20%20segment_data%2C%0A%20%20%20%20%20%20%20%20path%3D%5B%22cohort%22%2C%20%22ltv_tier%22%5D%2C%0A%20%20%20%20%20%20%20%20values%3D%22count%22%2C%0A%20%20%20%20%20%20%20%20color%3D%22churn_rate%22%2C%0A%20%20%20%20%20%20%20%20color_continuous_scale%3D%5B%22%232ca02c%22%2C%20%22%23bcbd22%22%2C%20%22%23ff7f0e%22%2C%20%22%23d62728%22%5D%2C%0A%20%20%20%20%20%20%20%20color_continuous_midpoint%3Dsegment_data%5B%22churn_rate%22%5D.mean()%2C%0A%20%20%20%20%20%20%20%20title%3D%22Customer%20Segmentation%3A%20Cohort%20%E2%86%92%20LTV%20Tier%20(Color%20%3D%20Churn%20Rate)%22%2C%0A%20%20%20%20%20%20%20%20hover_data%3D%7B%22churn_rate%22%3A%20%22%3A.1%25%22%2C%20%22avg_ltv%22%3A%20%22%3A%24%2C.0f%22%2C%20%22count%22%3A%20%22%3A%2C%22%7D%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20)%0A%0A%20%20%20%20fig_treemap.update_layout(%0A%20%20%20%20%20%20%20%20height%3D500%2C%0A%20%20%20%20%20%20%20%20coloraxis_colorbar%3D%7B%22title%22%3A%20%22Churn%20Rate%22%2C%20%22tickformat%22%3A%20%22.0%25%22%7D%2C%0A%20%20%20%20)%0A%20%20%20%20fig_treemap%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(COLORS%2C%20PLOT_TEMPLATE%2C%20customers%2C%20go%2C%20make_subplots)%3A%0A%20%20%20%20%23%20Horizontal%20stacked%20bar%20chart%20-%20replaces%20pie%20charts%20with%20more%20readable%20format%0A%20%20%20%20cohort_ltv%20%3D%20customers.groupby(%5B%22cohort%22%2C%20%22ltv_tier%22%5D).size().unstack(fill_value%3D0)%0A%0A%20%20%20%20fig_stacked%20%3D%20make_subplots(%0A%20%20%20%20%20%20%20%20rows%3D1%2C%20cols%3D2%2C%0A%20%20%20%20%20%20%20%20subplot_titles%3D(%22Customers%20by%20Cohort%20%26%20LTV%20Tier%22%2C%20%22Churn%20Rate%20by%20Segment%22)%2C%0A%20%20%20%20%20%20%20%20horizontal_spacing%3D0.15%2C%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Stacked%20bar%20for%20customer%20counts%0A%20%20%20%20for%20_i%2C%20ltv%20in%20enumerate(cohort_ltv.columns)%3A%0A%20%20%20%20%20%20%20%20fig_stacked.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Bar(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Dltv%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dcohort_ltv.index%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dcohort_ltv%5Bltv%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orientation%3D%22h%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker_color%3DCOLORS%5B%22ltv%22%5D.get(ltv%2C%20%22%23888%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3Dcohort_ltv%5Bltv%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20textposition%3D%22inside%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D1%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%23%20Churn%20rate%20by%20cohort%0A%20%20%20%20churn_by_cohort%20%3D%20customers.groupby(%22cohort%22)%5B%22churn_label%22%5D.mean().sort_values(ascending%3DTrue)%0A%20%20%20%20fig_stacked.add_trace(%0A%20%20%20%20%20%20%20%20go.Bar(%0A%20%20%20%20%20%20%20%20%20%20%20%20name%3D%22Churn%20Rate%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dchurn_by_cohort.index%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dchurn_by_cohort.values%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20orientation%3D%22h%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_color%3D%5BCOLORS%5B%22cohort%22%5D.get(c%2C%20%22%23888%22)%20for%20c%20in%20churn_by_cohort.index%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20text%3D%5Bf%22%7Bv%3A.1%25%7D%22%20for%20v%20in%20churn_by_cohort.values%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20textposition%3D%22outside%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D2%0A%20%20%20%20)%0A%0A%20%20%20%20fig_stacked.update_layout(%0A%20%20%20%20%20%20%20%20barmode%3D%22stack%22%2C%0A%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20title%3D%22Customer%20Distribution%20%26%20Churn%20by%20Segment%22%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20)%0A%20%20%20%20fig_stacked.update_xaxes(title_text%3D%22Customer%20Count%22%2C%20row%3D1%2C%20col%3D1)%0A%20%20%20%20fig_stacked.update_xaxes(title_text%3D%22Churn%20Rate%22%2C%20tickformat%3D%22.0%25%22%2C%20row%3D1%2C%20col%3D2)%0A%20%20%20%20fig_stacked%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%203.%20Multi-Dimensional%20Churn%20Analysis%0A%0A%20%20%20%20Examining%20churn%20rates%20across%20multiple%20dimensions%20simultaneously.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(COLORS%2C%20PLOT_TEMPLATE%2C%20customers%2C%20go%2C%20make_subplots)%3A%0A%20%20%20%20%23%20Multi-dimensional%20churn%20analysis%20-%20grouped%20bar%20chart%20with%20faceting%0A%20%20%20%20_churn_multi%20%3D%20customers.groupby(%5B%22cohort%22%2C%20%22ltv_tier%22%2C%20%22contract_type%22%5D).agg(%0A%20%20%20%20%20%20%20%20total%3D(%22customer_id%22%2C%20%22count%22)%2C%0A%20%20%20%20%20%20%20%20churned%3D(%22churn_label%22%2C%20%22sum%22)%2C%0A%20%20%20%20%20%20%20%20churn_rate%3D(%22churn_label%22%2C%20%22mean%22)%2C%0A%20%20%20%20).reset_index()%0A%0A%20%20%20%20%23%20Overall%20churn%20rate%20for%20reference%20line%0A%20%20%20%20overall_churn%20%3D%20customers%5B%22churn_label%22%5D.mean()%0A%0A%20%20%20%20%23%20Create%20faceted%20bar%20chart%20by%20contract%20type%0A%20%20%20%20_fig_multi%20%3D%20make_subplots(%0A%20%20%20%20%20%20%20%20rows%3D1%2C%20cols%3D3%2C%0A%20%20%20%20%20%20%20%20subplot_titles%3D%5B%22Month-to-month%22%2C%20%22One%20year%22%2C%20%22Two%20year%22%5D%2C%0A%20%20%20%20%20%20%20%20shared_yaxes%3DTrue%2C%0A%20%20%20%20%20%20%20%20horizontal_spacing%3D0.05%2C%0A%20%20%20%20)%0A%0A%20%20%20%20_contract_types%20%3D%20%5B%22Month-to-month%22%2C%20%22One%20year%22%2C%20%22Two%20year%22%5D%0A%0A%20%20%20%20for%20_i%2C%20_contract%20in%20enumerate(_contract_types%2C%201)%3A%0A%20%20%20%20%20%20%20%20_contract_data%20%3D%20_churn_multi%5B_churn_multi%5B%22contract_type%22%5D%20%3D%3D%20_contract%5D%0A%0A%20%20%20%20%20%20%20%20for%20_cohort%20in%20%5B%22new_user%22%2C%20%22established%22%2C%20%22mature%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_cohort_data%20%3D%20_contract_data%5B_contract_data%5B%22cohort%22%5D%20%3D%3D%20_cohort%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(_cohort_data)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_fig_multi.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20go.Bar(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D_cohort%20if%20_i%20%3D%3D%201%20else%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D_cohort_data%5B%22ltv_tier%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D_cohort_data%5B%22churn_rate%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker_color%3DCOLORS%5B%22cohort%22%5D.get(_cohort%2C%20%22%23888%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3D%5Bf%22%7Bv%3A.1%25%7D%22%20for%20v%20in%20_cohort_data%5B%22churn_rate%22%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20textposition%3D%22outside%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20legendgroup%3D_cohort%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3D(_i%20%3D%3D%201)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D_i%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20reference%20line%20for%20overall%20churn%0A%20%20%20%20%20%20%20%20_fig_multi.add_hline(%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Doverall_churn%2C%20line_dash%3D%22dash%22%2C%20line_color%3D%22gray%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20annotation_text%3Df%22Avg%3A%20%7Boverall_churn%3A.1%25%7D%22%20if%20_i%20%3D%3D%203%20else%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D_i%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20_fig_multi.update_layout(%0A%20%20%20%20%20%20%20%20barmode%3D%22group%22%2C%0A%20%20%20%20%20%20%20%20height%3D450%2C%0A%20%20%20%20%20%20%20%20title%3D%22%F0%9F%93%8A%20Churn%20Rate%20by%20Cohort%20%C3%97%20LTV%20Tier%20%C3%97%20Contract%20Type%22%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20%20%20%20%20legend_title%3D%22Cohort%22%2C%0A%20%20%20%20)%0A%20%20%20%20_fig_multi.update_yaxes(tickformat%3D%22.0%25%22%2C%20range%3D%5B0%2C%20min(_churn_multi%5B%22churn_rate%22%5D.max()%20*%201.3%2C%201)%5D)%0A%20%20%20%20_fig_multi%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%20(overall_churn%2C)%0A%0A%0A%40app.cell%0Adef%20_(PLOT_TEMPLATE%2C%20customers%2C%20go%2C%20overall_churn)%3A%0A%20%20%20%20%23%20Diverging%20bar%20chart%20-%20churn%20rate%20relative%20to%20average%0A%20%20%20%20churn_segments%20%3D%20customers.groupby(%5B%22cohort%22%2C%20%22ltv_tier%22%5D).agg(%0A%20%20%20%20%20%20%20%20churn_rate%3D(%22churn_label%22%2C%20%22mean%22)%2C%0A%20%20%20%20%20%20%20%20count%3D(%22customer_id%22%2C%20%22count%22)%0A%20%20%20%20).reset_index()%0A%0A%20%20%20%20churn_segments%5B%22segment%22%5D%20%3D%20churn_segments%5B%22cohort%22%5D%20%2B%20%22%20%2F%20%22%20%2B%20churn_segments%5B%22ltv_tier%22%5D%0A%20%20%20%20churn_segments%5B%22deviation%22%5D%20%3D%20churn_segments%5B%22churn_rate%22%5D%20-%20overall_churn%0A%20%20%20%20churn_segments%20%3D%20churn_segments.sort_values(%22deviation%22)%0A%0A%20%20%20%20%23%20Create%20diverging%20bar%20chart%0A%20%20%20%20fig_diverging%20%3D%20go.Figure()%0A%0A%20%20%20%20fig_diverging.add_trace(go.Bar(%0A%20%20%20%20%20%20%20%20y%3Dchurn_segments%5B%22segment%22%5D%2C%0A%20%20%20%20%20%20%20%20x%3Dchurn_segments%5B%22deviation%22%5D%2C%0A%20%20%20%20%20%20%20%20orientation%3D%22h%22%2C%0A%20%20%20%20%20%20%20%20marker_color%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%23d62728%22%20if%20d%20%3E%200%20else%20%22%232ca02c%22%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20d%20in%20churn_segments%5B%22deviation%22%5D%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20text%3D%5Bf%22%7Bd%3A%2B.1%25%7D%22%20for%20d%20in%20churn_segments%5B%22deviation%22%5D%5D%2C%0A%20%20%20%20%20%20%20%20textposition%3D%22outside%22%2C%0A%20%20%20%20%20%20%20%20hovertemplate%3D%22%3Cb%3E%25%7By%7D%3C%2Fb%3E%3Cbr%3EDeviation%3A%20%25%7Bx%3A.1%25%7D%3Cbr%3EChurn%20Rate%3A%20%25%7Bcustomdata%3A.1%25%7D%3Cextra%3E%3C%2Fextra%3E%22%2C%0A%20%20%20%20%20%20%20%20customdata%3Dchurn_segments%5B%22churn_rate%22%5D%2C%0A%20%20%20%20))%0A%0A%20%20%20%20fig_diverging.add_vline(x%3D0%2C%20line_dash%3D%22solid%22%2C%20line_color%3D%22gray%22%2C%20line_width%3D2)%0A%0A%20%20%20%20fig_diverging.update_layout(%0A%20%20%20%20%20%20%20%20title%3Df%22%F0%9F%93%88%20Churn%20Rate%20Deviation%20from%20Average%20(%7Boverall_churn%3A.1%25%7D)%22%2C%0A%20%20%20%20%20%20%20%20xaxis_title%3D%22Deviation%20from%20Average%20Churn%20Rate%22%2C%0A%20%20%20%20%20%20%20%20yaxis_title%3D%22Customer%20Segment%22%2C%0A%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20%20%20%20%20xaxis_tickformat%3D%22%2B.1%25%22%2C%0A%20%20%20%20)%0A%20%20%20%20fig_diverging%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%204.%20Cohort%20Churn%20Heatmap%0A%0A%20%20%20%20Visualizing%20churn%20patterns%20by%20signup%20month%20and%20customer%20age%20(months%20since%20signup).%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(PLOT_TEMPLATE%2C%20customers%2C%20go%2C%20pd)%3A%0A%20%20%20%20%23%20Build%20cohort%20heatmap%20data%0A%20%20%20%20%23%20X-axis%3A%20Signup%20month%20(calendar%20month)%0A%20%20%20%20%23%20Y-axis%3A%20Month%20number%20(months%20since%20signup%20when%20churn%20occurred)%0A%0A%20%20%20%20%23%20Create%20cohort%20analysis%20data%0A%20%20%20%20cohort_data%20%3D%20%5B%5D%0A%20%20%20%20for%20signup_month%20in%20customers%5B%22signup_month%22%5D.unique()%3A%0A%20%20%20%20%20%20%20%20month_customers%20%3D%20customers%5Bcustomers%5B%22signup_month%22%5D%20%3D%3D%20signup_month%5D%0A%20%20%20%20%20%20%20%20total_in_cohort%20%3D%20len(month_customers)%0A%0A%20%20%20%20%20%20%20%20for%20months_since%20in%20range(0%2C%2013)%3A%20%20%23%200-12%20months%0A%20%20%20%20%20%20%20%20%20%20%20%20churned_in_month%20%3D%20len(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20month_customers%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(month_customers%5B%22churn_label%22%5D)%20%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(month_customers%5B%22months_to_churn%22%5D%20%3E%3D%20months_since)%20%26%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(month_customers%5B%22months_to_churn%22%5D%20%3C%20months_since%20%2B%201)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20churn_rate%20%3D%20churned_in_month%20%2F%20total_in_cohort%20if%20total_in_cohort%20%3E%200%20else%200%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20cohort_data.append(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22signup_month%22%3A%20signup_month%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22months_since_signup%22%3A%20f%22Month%20%7Bmonths_since%7D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22churn_rate%22%3A%20churn_rate%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22churned_count%22%3A%20churned_in_month%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22cohort_size%22%3A%20total_in_cohort%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%0A%20%20%20%20cohort_df%20%3D%20pd.DataFrame(cohort_data)%0A%0A%20%20%20%20%23%20Pivot%20for%20heatmap%0A%20%20%20%20heatmap_data%20%3D%20cohort_df.pivot(%0A%20%20%20%20%20%20%20%20index%3D%22months_since_signup%22%2C%0A%20%20%20%20%20%20%20%20columns%3D%22signup_month%22%2C%0A%20%20%20%20%20%20%20%20values%3D%22churn_rate%22%0A%20%20%20%20).fillna(0)%0A%0A%20%20%20%20%23%20Sort%20columns%20by%20date%0A%20%20%20%20heatmap_data%20%3D%20heatmap_data%5Bsorted(heatmap_data.columns)%5D%0A%0A%20%20%20%20%23%20Create%20heatmap%0A%20%20%20%20fig_heatmap%20%3D%20go.Figure(data%3Dgo.Heatmap(%0A%20%20%20%20%20%20%20%20z%3Dheatmap_data.values%2C%0A%20%20%20%20%20%20%20%20x%3Dheatmap_data.columns%2C%0A%20%20%20%20%20%20%20%20y%3Dheatmap_data.index%2C%0A%20%20%20%20%20%20%20%20colorscale%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0%2C%20%22%231a9850%22%5D%2C%20%20%20%20%20%20%23%20Low%20churn%20-%20green%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.25%2C%20%22%2391cf60%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.5%2C%20%22%23ffffbf%22%5D%2C%20%20%20%20%23%20Medium%20-%20yellow%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B0.75%2C%20%22%23fc8d59%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B1%2C%20%22%23d73027%22%5D%2C%20%20%20%20%20%20%23%20High%20churn%20-%20red%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20colorbar%3D%7B%22title%22%3A%20%22Churn%20Rate%22%2C%20%22tickformat%22%3A%20%22.1%25%22%7D%2C%0A%20%20%20%20%20%20%20%20hovertemplate%3D%22Signup%3A%20%25%7Bx%7D%3Cbr%3E%25%7By%7D%3Cbr%3EChurn%20Rate%3A%20%25%7Bz%3A.2%25%7D%3Cextra%3E%3C%2Fextra%3E%22%2C%0A%20%20%20%20))%0A%0A%20%20%20%20fig_heatmap.update_layout(%0A%20%20%20%20%20%20%20%20title%3D%22Cohort%20Churn%20Heatmap%3A%20When%20Do%20Customers%20Churn%3F%22%2C%0A%20%20%20%20%20%20%20%20xaxis_title%3D%22Signup%20Month%20(Cohort)%22%2C%0A%20%20%20%20%20%20%20%20yaxis_title%3D%22Months%20Since%20Signup%22%2C%0A%20%20%20%20%20%20%20%20height%3D500%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20%20%20%20%20yaxis%3D%7B%22autorange%22%3A%20%22reversed%22%7D%2C%20%20%23%20Month%200%20at%20top%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Add%20annotations%20for%20high-churn%20cells%0A%20%20%20%20for%20_i%2C%20_row%20in%20enumerate(heatmap_data.index)%3A%0A%20%20%20%20%20%20%20%20for%20_j%2C%20_col%20in%20enumerate(heatmap_data.columns)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_val%20%3D%20heatmap_data.loc%5B_row%2C%20_col%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20_val%20%3E%200.02%3A%20%20%23%20Only%20annotate%20significant%20churn%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig_heatmap.add_annotation(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D_col%2C%20y%3D_row%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3Df%22%7B_val%3A.1%25%7D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showarrow%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font%3D%7B%22size%22%3A%208%2C%20%22color%22%3A%20%22white%22%20if%20_val%20%3E%200.03%20else%20%22black%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20fig_heatmap%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%20(cohort_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(COLORS%2C%20PLOT_TEMPLATE%2C%20cohort_df%2C%20px)%3A%0A%20%20%20%20%23%20Aggregate%20cohort%20trends%20-%20line%20chart%20showing%20churn%20by%20month%20since%20signup%0A%20%20%20%20cohort_trend%20%3D%20cohort_df.groupby(%22months_since_signup%22).agg(%0A%20%20%20%20%20%20%20%20avg_churn_rate%3D(%22churn_rate%22%2C%20%22mean%22)%2C%0A%20%20%20%20%20%20%20%20total_churned%3D(%22churned_count%22%2C%20%22sum%22)%2C%0A%20%20%20%20).reset_index()%0A%0A%20%20%20%20fig_cohort_trend%20%3D%20px.line(%0A%20%20%20%20%20%20%20%20cohort_trend%2C%0A%20%20%20%20%20%20%20%20x%3D%22months_since_signup%22%2C%0A%20%20%20%20%20%20%20%20y%3D%22avg_churn_rate%22%2C%0A%20%20%20%20%20%20%20%20markers%3DTrue%2C%0A%20%20%20%20%20%20%20%20title%3D%22Average%20Churn%20Rate%20by%20Months%20Since%20Signup%22%2C%0A%20%20%20%20%20%20%20%20labels%3D%7B%22avg_churn_rate%22%3A%20%22Churn%20Rate%22%2C%20%22months_since_signup%22%3A%20%22Months%20Since%20Signup%22%7D%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20)%0A%0A%20%20%20%20fig_cohort_trend.update_traces(%0A%20%20%20%20%20%20%20%20line%3D%7B%22color%22%3A%20COLORS%5B%22danger%22%5D%2C%20%22width%22%3A%203%7D%2C%0A%20%20%20%20%20%20%20%20marker%3D%7B%22size%22%3A%2010%7D%2C%0A%20%20%20%20)%0A%0A%20%20%20%20fig_cohort_trend.update_layout(%0A%20%20%20%20%20%20%20%20height%3D350%2C%0A%20%20%20%20%20%20%20%20yaxis_tickformat%3D%22.1%25%22%2C%0A%20%20%20%20)%0A%20%20%20%20fig_cohort_trend%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%205.%20Engagement%20Analysis%0A%0A%20%20%20%20Comparing%20behavioral%20patterns%20between%20churned%20and%20retained%20customers.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(COLORS%2C%20PLOT_TEMPLATE%2C%20customers%2C%20daily_engagement%2C%20go%2C%20make_subplots)%3A%0A%20%20%20%20%23%20Merge%20engagement%20with%20customer%20info%0A%20%20%20%20engagement_with_churn%20%3D%20daily_engagement.merge(%0A%20%20%20%20%20%20%20%20customers%5B%5B%22customer_id%22%2C%20%22churn_label%22%2C%20%22cohort%22%2C%20%22ltv_tier%22%5D%5D%2C%0A%20%20%20%20%20%20%20%20on%3D%22customer_id%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Calculate%20customer-level%20engagement%20metrics%0A%20%20%20%20customer_engagement%20%3D%20engagement_with_churn.groupby(%5B%22customer_id%22%2C%20%22churn_label%22%5D).agg(%0A%20%20%20%20%20%20%20%20avg_logins%3D(%22login_count%22%2C%20%22mean%22)%2C%0A%20%20%20%20%20%20%20%20avg_features%3D(%22features_used%22%2C%20%22mean%22)%2C%0A%20%20%20%20%20%20%20%20avg_session%3D(%22session_duration_minutes%22%2C%20%22mean%22)%2C%0A%20%20%20%20%20%20%20%20total_days%3D(%22login_count%22%2C%20%22count%22)%2C%0A%20%20%20%20).reset_index()%0A%0A%20%20%20%20customer_engagement%5B%22churn_status%22%5D%20%3D%20customer_engagement%5B%22churn_label%22%5D.map(%0A%20%20%20%20%20%20%20%20%7BTrue%3A%20%22Churned%22%2C%20False%3A%20%22Retained%22%7D%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Create%20box%20plots%20for%20engagement%20comparison%0A%20%20%20%20fig_engagement%20%3D%20make_subplots(%0A%20%20%20%20%20%20%20%20rows%3D1%2C%20cols%3D3%2C%0A%20%20%20%20%20%20%20%20subplot_titles%3D%5B%22Avg%20Daily%20Logins%22%2C%20%22Avg%20Features%20Used%22%2C%20%22Avg%20Session%20Duration%20(min)%22%5D%2C%0A%20%20%20%20%20%20%20%20horizontal_spacing%3D0.08%2C%0A%20%20%20%20)%0A%0A%20%20%20%20for%20_i%2C%20(_col%2C%20_title)%20in%20enumerate(%5B%0A%20%20%20%20%20%20%20%20(%22avg_logins%22%2C%20%22Logins%22)%2C%0A%20%20%20%20%20%20%20%20(%22avg_features%22%2C%20%22Features%22)%2C%0A%20%20%20%20%20%20%20%20(%22avg_session%22%2C%20%22Session%20Duration%22)%0A%20%20%20%20%5D%2C%201)%3A%0A%20%20%20%20%20%20%20%20for%20_status%20in%20%5B%22Retained%22%2C%20%22Churned%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_data%20%3D%20customer_engagement%5Bcustomer_engagement%5B%22churn_status%22%5D%20%3D%3D%20_status%5D%5B_col%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20fig_engagement.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20go.Box(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D_data%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D_status%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker_color%3DCOLORS%5B%22retained%22%5D%20if%20_status%20%3D%3D%20%22Retained%22%20else%20COLORS%5B%22churned%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20legendgroup%3D_status%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3D(_i%20%3D%3D%201)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20boxmean%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D_i%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20fig_engagement.update_layout(%0A%20%20%20%20%20%20%20%20title%3D%22Engagement%20Distribution%3A%20Churned%20vs%20Retained%20Customers%22%2C%0A%20%20%20%20%20%20%20%20height%3D450%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20%20%20%20%20boxmode%3D%22group%22%2C%0A%20%20%20%20)%0A%20%20%20%20fig_engagement%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%20(customer_engagement%2C)%0A%0A%0A%40app.cell%0Adef%20_(COLORS%2C%20PLOT_TEMPLATE%2C%20customer_engagement%2C%20go%2C%20make_subplots)%3A%0A%20%20%20%20%23%20Violin%20plots%20for%20richer%20distribution%20view%0A%20%20%20%20fig_violin%20%3D%20make_subplots(%0A%20%20%20%20%20%20%20%20rows%3D1%2C%20cols%3D3%2C%0A%20%20%20%20%20%20%20%20subplot_titles%3D%5B%22Avg%20Daily%20Logins%22%2C%20%22Avg%20Features%20Used%22%2C%20%22Avg%20Session%20Duration%22%5D%2C%0A%20%20%20%20%20%20%20%20horizontal_spacing%3D0.08%2C%0A%20%20%20%20)%0A%0A%20%20%20%20for%20_i%2C%20_col%20in%20enumerate(%5B%22avg_logins%22%2C%20%22avg_features%22%2C%20%22avg_session%22%5D%2C%201)%3A%0A%20%20%20%20%20%20%20%20for%20_status%20in%20%5B%22Retained%22%2C%20%22Churned%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_data%20%3D%20customer_engagement%5Bcustomer_engagement%5B%22churn_status%22%5D%20%3D%3D%20_status%5D%5B_col%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20fig_violin.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20go.Violin(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D_data%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3D_status%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20side%3D%22positive%22%20if%20_status%20%3D%3D%20%22Retained%22%20else%20%22negative%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker_color%3DCOLORS%5B%22retained%22%5D%20if%20_status%20%3D%3D%20%22Retained%22%20else%20COLORS%5B%22churned%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20legendgroup%3D_status%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3D(_i%20%3D%3D%201)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20meanline_visible%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20box_visible%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20row%3D1%2C%20col%3D_i%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20fig_violin.update_layout(%0A%20%20%20%20%20%20%20%20title%3D%22Engagement%20Distribution%20(Violin%20Plot)%20-%20Churned%20vs%20Retained%22%2C%0A%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20%20%20%20%20violinmode%3D%22overlay%22%2C%0A%20%20%20%20)%0A%20%20%20%20fig_violin%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%206.%20Feature%20Correlations%0A%0A%20%20%20%20Understanding%20relationships%20between%20key%20features%20and%20churn.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(PLOT_TEMPLATE%2C%20customers%2C%20go%2C%20np)%3A%0A%20%20%20%20%23%20Select%20numeric%20columns%20for%20correlation%20analysis%0A%20%20%20%20numeric_cols%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22tenure_days%22%2C%20%22monthly_charges%22%2C%20%22estimated_ltv%22%2C%0A%20%20%20%20%20%20%20%20%22churn_label%22%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20Add%20available%20engagement-related%20columns%20if%20they%20exist%0A%20%20%20%20for%20_c%20in%20%5B%22n_addon_services%22%5D%3A%0A%20%20%20%20%20%20%20%20if%20_c%20in%20customers.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20numeric_cols.append(_c)%0A%0A%20%20%20%20corr_matrix%20%3D%20customers%5Bnumeric_cols%5D.corr()%0A%0A%20%20%20%20%23%20Create%20correlation%20heatmap%0A%20%20%20%20fig_corr%20%3D%20go.Figure(data%3Dgo.Heatmap(%0A%20%20%20%20%20%20%20%20z%3Dcorr_matrix.values%2C%0A%20%20%20%20%20%20%20%20x%3Dcorr_matrix.columns%2C%0A%20%20%20%20%20%20%20%20y%3Dcorr_matrix.index%2C%0A%20%20%20%20%20%20%20%20colorscale%3D%22RdBu_r%22%2C%0A%20%20%20%20%20%20%20%20zmid%3D0%2C%0A%20%20%20%20%20%20%20%20text%3Dnp.round(corr_matrix.values%2C%202)%2C%0A%20%20%20%20%20%20%20%20texttemplate%3D%22%25%7Btext%7D%22%2C%0A%20%20%20%20%20%20%20%20textfont%3D%7B%22size%22%3A%2010%7D%2C%0A%20%20%20%20%20%20%20%20colorbar%3D%7B%22title%22%3A%20%22Correlation%22%7D%2C%0A%20%20%20%20))%0A%0A%20%20%20%20fig_corr.update_layout(%0A%20%20%20%20%20%20%20%20title%3D%22Feature%20Correlation%20Matrix%22%2C%0A%20%20%20%20%20%20%20%20height%3D450%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20%20%20%20%20xaxis%3D%7B%22tickangle%22%3A%2045%7D%2C%0A%20%20%20%20)%0A%20%20%20%20fig_corr%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(COLORS%2C%20PLOT_TEMPLATE%2C%20customers%2C%20go%2C%20np%2C%20pd)%3A%0A%20%20%20%20%23%20Feature%20importance%20for%20churn%20-%20bar%20chart%20of%20correlations%20with%20churn_label%0A%20%20%20%20numeric_features%20%3D%20customers.select_dtypes(include%3D%5B%22number%22%5D).columns.tolist()%0A%20%20%20%20exclude%20%3D%20%5B%22churn_label%22%2C%20%22customer_id%22%5D%0A%20%20%20%20numeric_features%20%3D%20%5Bf%20for%20f%20in%20numeric_features%20if%20f%20not%20in%20exclude%20and%20not%20f.endswith(%22_id%22)%5D%0A%0A%20%20%20%20correlations%20%3D%20%5B%5D%0A%20%20%20%20for%20_feat%20in%20numeric_features%3A%0A%20%20%20%20%20%20%20%20if%20_feat%20in%20customers.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_corr%20%3D%20customers%5B_feat%5D.corr(customers%5B%22churn_label%22%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20np.isnan(_corr)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20correlations.append(%7B%22feature%22%3A%20_feat%2C%20%22correlation%22%3A%20_corr%7D)%0A%0A%20%20%20%20corr_df%20%3D%20pd.DataFrame(correlations).sort_values(%22correlation%22%2C%20key%3Dabs%2C%20ascending%3DTrue)%0A%0A%20%20%20%20fig_feature_corr%20%3D%20go.Figure()%0A%0A%20%20%20%20fig_feature_corr.add_trace(go.Bar(%0A%20%20%20%20%20%20%20%20y%3Dcorr_df%5B%22feature%22%5D%2C%0A%20%20%20%20%20%20%20%20x%3Dcorr_df%5B%22correlation%22%5D%2C%0A%20%20%20%20%20%20%20%20orientation%3D%22h%22%2C%0A%20%20%20%20%20%20%20%20marker_color%3D%5BCOLORS%5B%22danger%22%5D%20if%20c%20%3E%200%20else%20COLORS%5B%22success%22%5D%20for%20c%20in%20corr_df%5B%22correlation%22%5D%5D%2C%0A%20%20%20%20%20%20%20%20text%3D%5Bf%22%7Bc%3A%2B.3f%7D%22%20for%20c%20in%20corr_df%5B%22correlation%22%5D%5D%2C%0A%20%20%20%20%20%20%20%20textposition%3D%22outside%22%2C%0A%20%20%20%20))%0A%0A%20%20%20%20fig_feature_corr.add_vline(x%3D0%2C%20line_color%3D%22gray%22%2C%20line_width%3D2)%0A%0A%20%20%20%20fig_feature_corr.update_layout(%0A%20%20%20%20%20%20%20%20title%3D%22Feature%20Correlation%20with%20Churn%22%2C%0A%20%20%20%20%20%20%20%20xaxis_title%3D%22Correlation%20Coefficient%22%2C%0A%20%20%20%20%20%20%20%20yaxis_title%3D%22Feature%22%2C%0A%20%20%20%20%20%20%20%20height%3Dmax(400%2C%20len(corr_df)%20*%2025)%2C%0A%20%20%20%20%20%20%20%20template%3DPLOT_TEMPLATE%2C%0A%20%20%20%20)%0A%20%20%20%20fig_feature_corr%20%20%23%20noqa%3A%20B018%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%207.%20Summary%20%26%20Key%20Insights%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(customers%2C%20mo%2C%20overall_churn)%3A%0A%20%20%20%20%23%20Calculate%20key%20statistics%0A%20%20%20%20churn_by_cohort_summary%20%3D%20customers.groupby(%22cohort%22)%5B%22churn_label%22%5D.mean()%0A%20%20%20%20churn_by_contract_summary%20%3D%20customers.groupby(%22contract_type%22)%5B%22churn_label%22%5D.mean()%0A%20%20%20%20churn_by_ltv_summary%20%3D%20customers.groupby(%22ltv_tier%22)%5B%22churn_label%22%5D.mean()%0A%0A%20%20%20%20highest_churn_cohort%20%3D%20churn_by_cohort_summary.idxmax()%0A%20%20%20%20highest_churn_contract%20%3D%20churn_by_contract_summary.idxmax()%0A%0A%20%20%20%20summary%20%3D%20f%22%22%22%0A%20%20%20%20%23%23%23%20Dataset%20Summary%0A%0A%20%20%20%20%7C%20Metric%20%7C%20Value%20%7C%0A%20%20%20%20%7C--------%7C-------%7C%0A%20%20%20%20%7C%20**Total%20Customers**%20%7C%20%7Blen(customers)%3A%2C%7D%20%7C%0A%20%20%20%20%7C%20**Overall%20Churn%20Rate**%20%7C%20%7Boverall_churn%3A.1%25%7D%20%7C%0A%20%20%20%20%7C%20**Avg%20Monthly%20Revenue**%20%7C%20%24%7Bcustomers%5B'monthly_charges'%5D.mean()%3A%2C.0f%7D%20%7C%0A%20%20%20%20%7C%20**Avg%20Estimated%20LTV**%20%7C%20%24%7Bcustomers%5B'estimated_ltv'%5D.mean()%3A%2C.0f%7D%20%7C%0A%20%20%20%20%7C%20**Date%20Range**%20%7C%20%7Bcustomers%5B'signup_month'%5D.min()%7D%20to%20%7Bcustomers%5B'signup_month'%5D.max()%7D%20%7C%0A%0A%20%20%20%20%23%23%23%20Churn%20Rate%20by%20Segment%0A%0A%20%20%20%20%7C%20Cohort%20%7C%20Churn%20Rate%20%7C%20%7C%20LTV%20Tier%20%7C%20Churn%20Rate%20%7C%0A%20%20%20%20%7C--------%7C------------%7C---%7C----------%7C------------%7C%0A%20%20%20%20%7C%20New%20User%20%7C%20%7Bchurn_by_cohort_summary.get('new_user'%2C%200)%3A.1%25%7D%20%7C%20%7C%20SMB%20%7C%20%7Bchurn_by_ltv_summary.get('smb'%2C%200)%3A.1%25%7D%20%7C%0A%20%20%20%20%7C%20Established%20%7C%20%7Bchurn_by_cohort_summary.get('established'%2C%200)%3A.1%25%7D%20%7C%20%7C%20Mid-Market%20%7C%20%7Bchurn_by_ltv_summary.get('mid_market'%2C%200)%3A.1%25%7D%20%7C%0A%20%20%20%20%7C%20Mature%20%7C%20%7Bchurn_by_cohort_summary.get('mature'%2C%200)%3A.1%25%7D%20%7C%20%7C%20Enterprise%20%7C%20%7Bchurn_by_ltv_summary.get('enterprise'%2C%200)%3A.1%25%7D%20%7C%0A%0A%20%20%20%20%23%23%23%20Key%20Insights%0A%0A%20%20%20%201.%20**%20Highest%20Risk%3A**%20%60%7Bhighest_churn_cohort%7D%60%20cohort%20with%20%60%7Bhighest_churn_contract%7D%60%20contracts%0A%20%20%20%202.%20**%20Early%20Churn%3A**%20Most%20churn%20occurs%20in%20first%203%20months%20(see%20cohort%20heatmap)%0A%20%20%20%203.%20**%20Engagement%20Signal%3A**%20Churners%20show%20significantly%20lower%20engagement%20metrics%0A%20%20%20%204.%20**%20LTV%20Paradox%3A**%20Enterprise%20customers%20churn%20less%20but%20each%20loss%20is%20high-impact%0A%20%20%20%205.%20**%20Contract%20Lock-in%3A**%20Annual%2Fbiennial%20contracts%20reduce%20churn%20substantially%0A%0A%20%20%20%20%23%23%23%20Next%20Steps%0A%0A%20%20%20%20-%20**Feature%20Engineering%3A**%20Create%20velocity%20features%20from%20engagement%20trends%0A%20%20%20%20-%20**Cohort-Specific%20Models%3A**%20Consider%20separate%20models%20for%20new%20vs%20established%20users%0A%20%20%20%20-%20**Intervention%20Timing%3A**%20Focus%20retention%20efforts%20in%20months%201-3%0A%20%20%20%20-%20**Contract%20Strategy%3A**%20Incentivize%20longer%20contract%20terms%20for%20high-risk%20segments%0A%20%20%20%20%22%22%22%0A%0A%20%20%20%20mo.md(summary)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">e316a2f5692a85b851cded1d8f4417f4</marimo-code-hash>
</body>
</html>
